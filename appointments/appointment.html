{% extends 'base.html' %}
{% load static %}
{% block title %}Appointment{% endblock %}

{% block extra-styles %}
    <!-- Make sure Tailwind CSS is loaded in your base.html or here -->
    <!-- <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet"> -->
{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto mt-10 bg-blue-600 rounded-2xl shadow-lg p-8 ">
    <div class="flex justify-center mb-8">
        <form id="search-form" action="{% url 'appointments:doctor_search' %}" method="get" class="flex w-full max-w-lg">
            <input type="text" id="search-input" name="q" placeholder="Search doctors..." class="flex-1 px-4 py-2 border text-black border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition"/>
            <button type="submit" id="search-button" class="px-6 py-2 bg-purple-600 text-white rounded-r-lg hover:bg-blue-700 transition">Search</button>
        </form>
    </div>

    <div class="flex flex-wrap gap-8 justify-center">
        {% if doctors %}
            {% for doctor in doctors %}
                <div class="bg-gray-50 rounded-xl shadow-md flex flex-col w-80 p-6 mb-6 hover:shadow-xl transition">
                    <div class="flex justify-center items-center mb-4">
                        <img src="{% static 'image/' %}{{ doctor.image.name }}" alt="Doctor Image" class="w-24 h-24 object-cover rounded-full border-2 border-blue-500 shadow"/>
                    </div>
                    <div class="text-center mb-4">
                        <h1 class="text-xl font-semibold text-blue-700 mb-1 doctor-name">{{ doctor.name }}</h1>
                        <p class="text-gray-700 mb-1 doctor-specialty">{{ doctor.specialty }}</p>
                        <p class="text-gray-800 mb-1 doctor-cost">Payment: {{ doctor.cost }}</p>
                        <p class="font-bold text-blue-600">Available spots: {{ doctor.available_spots }}</p>
                    </div>
                    <div class="bg-blue-50 rounded-md p-3 mb-4">
                        <h2 class="text-blue-700 text-base font-medium mb-2">Appointment Slots</h2>
                        <ul class="space-y-1">
                            {% for slot in doctor.doctortimeslot_set.all %}
                                <li class="text-gray-800 text-sm"><strong>Time:</strong> {{ slot.start_time }} - {{ slot.end_time }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                    <div class="flex justify-center items-center min-h-[38px]">
                        {% if doctor.available_spots > 0 and doctor.status %}
                            <a class="bg-gradient-to-r from-blue-600 to-blue-400 text-white font-medium px-5 py-2 rounded-md shadow hover:from-blue-700 hover:to-blue-500 transition" href="{% url 'appointments:create_appointment' doctor.id %}">Create Appointment</a>
                        {% else %}
                            <span class="bg-gray-200 text-gray-500 px-5 py-2 rounded-md font-medium border border-gray-300">Unavailable</span>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        {% endif %}
    </div>
</div>
{% endblock %}